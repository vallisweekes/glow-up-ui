// Glow Up UI - Database Schema (Simplified for Current App)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Shared monthly template (admin-created, applies to both users)
model SharedTemplate {
  id    String @id @default(cuid())
  month String @unique // YYYY-MM format
  
  title  String @default("")
  focus  String @default("")
  
  morningRoutine Json // Array of task templates: {id, text}[]
  healthHabits   Json // Array of task templates: {id, text}[]
  nightRoutine   Json // Array of task templates: {id, text}[]
  weeklyGoals    Json // Array of goal strings
  readingGoal    String?
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@index([month])
}

// Daily progress for each user
model DailyRoutine {
  id        String   @id @default(cuid())
  date      String   // YYYY-MM-DD format
  month     String   // YYYY-MM format
  user      String   // "Vallis" or "Kashina"
  
  morningRoutine Json // Array of tasks: {id, text, completed}[]
  healthHabits   Json // Array of tasks: {id, text, completed}[]
  nightRoutine   Json // Array of tasks: {id, text, completed}[]
  nutrition      Json // {breakfast, lunch, dinner}
  
  pushUpsCount Int @default(0)
  stepsCount   Int @default(0)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@unique([date, user])
  @@index([user, date])
  @@index([user, month])
}

model WeeklyCheckIn {
  id         String   @id @default(cuid())
  weekNumber Int
  month      String   // YYYY-MM format
  year       Int
  user       String   // "Vallis" or "Kashina"
  
  glowUpEntries         Json     // Array of {id, text, createdAt}
  customGoals           Json     // Array of {id, text, completed}
  
  oneWin     String @default("")
  oneProud   String @default("")
  oneImprove String @default("")
  customReflections     Json     // Array of {id, label, text}
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@unique([user, year, month, weekNumber])
  @@index([user, year, month])
}

model MonthlyReading {
  id          String   @id @default(cuid())
  month       String   // YYYY-MM format
  user        String   // "Vallis" or "Kashina"
  
  bookTitle      String  @default("")
  readThisWeek   Json    // Array of booleans [true, false, ...]
  finishedBook   Boolean @default(false)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  @@unique([user, month])
  @@index([user, month])
}
