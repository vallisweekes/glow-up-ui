generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id               String                   @id @default(cuid())
  name             String                   @unique
  pin              String?
  createdAt        DateTime                 @default(now())
  updatedAt        DateTime                 @updatedAt
  dailyRoutines    DailyRoutine[]
  monthlyReadings  MonthlyReading[]
  monthlyTemplates MonthlyRoutineTemplate[]
  weeklyCheckIns   WeeklyCheckIn[]
}

model SharedTemplate {
  id             String   @id @default(cuid())
  month          String   @unique
  title          String   @default("")
  focus          String   @default("")
  morningRoutine Json
  healthHabits   Json
  nightRoutine   Json
  weeklyGoals    Json
  readingGoal    String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@index([month])
}

model DailyRoutine {
  id             String   @id @default(cuid())
  date           String
  month          String
  morningRoutine Json
  healthHabits   Json
  nightRoutine   Json
  nutrition      Json
  pushUpsCount   Int      @default(0)
  stepsCount     Int      @default(0)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  userId         String
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([date, userId])
  @@index([userId, date])
  @@index([userId, month])
}

model WeeklyCheckIn {
  id                String   @id @default(cuid())
  weekNumber        Int
  month             String
  year              Int
  glowUpEntries     Json
  customGoals       Json
  oneWin            String   @default("")
  oneProud          String   @default("")
  oneImprove        String   @default("")
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  customReflections Json
  userId            String
  user              User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, year, month, weekNumber])
  @@index([userId, year, month])
}

model MonthlyReading {
  id           String   @id @default(cuid())
  month        String
  bookTitle    String   @default("")
  readThisWeek Json
  finishedBook Boolean  @default(false)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  userId       String
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, month])
  @@index([userId, month])
}

model MonthlyRoutineTemplate {
  id             String   @id @default(cuid())
  month          String
  userId         String
  morningRoutine Json
  healthHabits   Json
  nightRoutine   Json
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, month])
  @@index([userId, month])
}
